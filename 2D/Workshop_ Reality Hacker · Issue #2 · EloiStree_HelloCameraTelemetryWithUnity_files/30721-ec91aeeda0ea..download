"use strict";(globalThis.webpackChunk_github_ui_github_ui=globalThis.webpackChunk_github_ui_github_ui||[]).push([[30721],{30721:(e,t,r)=>{r.d(t,{mf:()=>P.RelayEnvironmentProvider,VB:()=>SSRNetwork,SD:()=>F,E7:()=>j});var i=r(50467),s=r(40961),a=r(69487),n=r(37285),o=r(96379),l=r(56038),c=r(38102);let u=["NOT_FOUND","SAML","SERVICE_UNAVAILABLE","FORBIDDEN","AUTHENTICATION"];var d=r(51987),h=r(86185),p=r(69599);let f=class ValidationError extends Error{constructor(e,t,r){super(e,t),(0,i._)(this,"catalogService",void 0),this.catalogService=r,this.name="ValidationError"}},_=class RateLimitError extends Error{constructor(e,t,...r){super(...r),(0,i._)(this,"retryAfter",void 0),(0,i._)(this,"resetTime",void 0),this.retryAfter=e,this.resetTime=t,this.name="RateLimitError"}},m=class ServiceUnavailableError extends Error{constructor(...e){super(...e),this.name="ServiceUnavailableError"}},E=class NotAcceptableError extends Error{constructor(...e){super(...e),this.name="NotAcceptableError"}},y=class SecFetchHeaderError extends Error{constructor(...e){super(...e),this.name="SecFetchHeaderError"}},w=class FetchNetworkError extends Error{constructor(...e){super(...e),this.name="FetchNetworkError"}};async function g(e,t,r){if(e.status>401&&404!==e.status){let i=await e.text(),s={url:e.url,timestamp:new Date().toISOString(),persistedQueryId:t,persistedQueryName:r,failureRequestId:e.headers.get("X-Github-Request-Id")},a=`HTTP error (${e.status}): ${i||"No additional text"}.
    Error Info: ${JSON.stringify(s)}`;if(429===e.status)throw new _(Number(e.headers.get("Retry-After")),Number(e.headers.get("X-RateLimit-Reset")),a,{cause:e.status});if(503===e.status)throw new m(a,{cause:e.status});if(406===e.status)throw new E(a,{cause:e.status});else if(422===e.status&&(i.includes("sec-fetch-dest")||i.includes("sec-fetch-site")))throw new y(a,{cause:e.status});throw Error(a,{cause:e.status})}}async function v(e,t,r,i="GET",s,a,n,o,l){return(await b(e,t,r,i,{isSubscription:!1,scope:void 0,preheatSource:l},s,a,n,o)).response}async function b(e,t,r,i="POST",s={},o,d,h,_){let m=JSON.stringify((0,a.stableCopy)({persistedQueryName:t,query:e,variables:r,...s.scopeObject?{scopeObject:s.scopeObject}:{}})),{isSubscription:E,scope:y,subscriptionTopic:w,dispatchTime:g}=s,v=o;void 0===o||""!==o&&o.endsWith("/_graphql")||((0,c.N7)(Error(`fetchGraphQL received invalid baseUrl - must end with /_graphql persistedQueryId: ${e}, persistedQueryName: ${t}, invalidBaseUrl: ${o}`)),v=void 0);let A=function(e,t,r,i,s,a,n="/_graphql"){let o=[];if("GET"===e&&o.push(`body=${t}`),r&&o.push("subscription=1"),s&&o.push(`scope=${encodeURIComponent(s)}`),i&&o.push(`subscriptionTopic=${encodeURIComponent(i)}`),a&&o.push(`dispatchTime=${encodeURIComponent(a)}`),l.cg){let e=new URL(l.cg.location.href,l.cg.location.origin).searchParams.get("_features");e&&o.push(`_features=${e}`)}return o.length>0?`${n}?${o.join("&")}`:n}(i,encodeURIComponent(m),E,w,y,g,v),O=null;try{let{subscriptionId:r,requestId:a,json:o}=await S(A,i,e,t,m,d,s.preheatSource);if(O=r,!function(e,t,r){let i=("errors"in e?e.errors:[]).filter(e=>!u.includes(e.type));if("errors"in e&&i.length){let t=i.map(e=>`GraphQL error: ${e.type}: ${e.message} (path: ${e.path})`).join(", "),s=new f(`${t} (Persisted query id: ${r})`,{cause:i},e.extensions?.query_owning_catalog_service);(0,c.N7)(s)}if(!("data"in e)){let i=function e(t){if(null==t)return t;if(Array.isArray(t))return t.map(t=>null==t?t:"object"==typeof t?e(t):"[FILTERED]");if("object"==typeof t){let r={};for(let i in t)if(Object.prototype.hasOwnProperty.call(t,i)){let s=t[i];"errors"===i||null==s?r[i]=s:"object"==typeof s?r[i]=e(s):r[i]="[FILTERED]"}return r}return t}(e),s=Error(`Expected data property in response: ${JSON.stringify(i)}. persistedQueryId: ${r}, requestId: ${t}`);(0,c.N7)(s)}}(o,a,e),o)if(_){let e={__trace:{...o?.__trace,cache_result:"refresh"}};(0,n.Av)(e)}else(0,n.Av)(o);return{subscriptionId:O,response:o}}catch(e){if(h){let t,r=e?.name;"RateLimitError"===(t=e?.name)||"SecFetchHeaderError"===t||"NotAcceptableError"===t||"FetchNetworkError"===t||"ServiceUnavailableError"===t&&(0,p.G7)("failbot_ignore_503_for_anonymous_users")&&(0,c.ff)()||(0,c.N7)(e);let i={};if(("RateLimitError"===r||"ServiceUnavailableError"===r)&&(i={backoff:!0,errorType:r},"RateLimitError"===r)){let t=e.retryAfter;void 0===t||isNaN(t)||(i={...i,retryAfter:t});let r=e.resetTime;void 0===r||isNaN(r)||(i={...i,resetTime:r})}return h.error(e),{subscriptionId:O,response:{errors:[{message:"An error occurred while fetching data. Please try again later."}],extensions:i}}}throw e}}async function S(e,t,r,i,s,a,o){return A((0,n.RD)(e),t,r,i,s,a,o)}async function A(e,t,r,i,s,a,n){let u,p,f={...(0,d.kt)(),...n?{"X-GITHUB-PREHEAT":n}:{}};a?.issues_react_perf_test&&(f["X-LUC-Environment"]="issues");let _=(u="GET"===t?await fetch(e,{method:t,cache:"no-cache",credentials:"include",headers:{Accept:"application/json",...f}}):await (0,o.DI)(e,{method:t,headers:{Accept:"application/json",...f},...s?{body:s}:void 0})).headers.get("X-Subscription-ID"),m=u.headers.get("X-Github-Request-Id")||"",E=u.status;if(h.z.checkResponse(u),await g(u,r,i),404===E&&"POST"===t)throw l.cg?.location.reload(),Error("Reloading page due to 404 on GraphQL mutation for unauthenticated user.");try{p=await u.json()}catch(r){let t={error:r instanceof Error?`${r.name}: ${r.message}`:String(r),status:E,url:e,requestId:m};if(r instanceof Error&&"TypeError"===r.name&&"Failed to fetch"===r.message)throw new w(`Network error while reading response. Please check your connection and try again. ${JSON.stringify(t)}`);throw(0,c.N7)(Error(`Failed to parse server JSON response ${JSON.stringify(t)}`)),Error(`Failed to parse server response. Please try again later. ${JSON.stringify(t)}`)}return{subscriptionId:_,requestId:m,json:p,status:E}}let O=[{kind:"linked",handle(e,t,r){if(null!=t&&t.getType()===a.ROOT_TYPE&&"node"===e.name&&r.hasOwnProperty("id"))return r.id}},{kind:"pluralLinked",handle(e,t,r){if(null!=t&&t.getType()===a.ROOT_TYPE&&"nodes"===e.name&&r.hasOwnProperty("ids"))return r.ids}}];var T=r(11418),C=r(73056),R=r(69982);function k(e){return(0,R.unstable_scheduleCallback)(R.unstable_LowPriority,e)}var N=r(6923),D=r(87683),I=r(53419),x=r(21067),L=r(82606),P=r(18312);function $(e){let t=e?.ttl,r=e?.defaultValues,i=e?.[D.Zm.EXCLUDE_FROM_CACHE_KEY],s=e?.preheatSource;return{cacheTTL:t,defaultValues:r,keysToExclude:i,preheatSource:s,skipCache:e?.skipCache,cacheEnabledForQuery:void 0!==t&&t>0}}async function M({params:e,variables:t,baseUrl:r,enabledFeatures:i,observer:s,isClientSideCachingEnabled:a,cache:n,metadata:o,preloadSubscriptions:l}){if(!e.id)throw Error("Params has no id property!");let{cacheTTL:c,defaultValues:u,keysToExclude:d,preheatSource:h,skipCache:p,cacheEnabledForQuery:f}=$(o),_="mutation"===e.operationKind?"POST":"GET",m=a=>v(e.id,e.name,t,_,r,i,s,a,p?"force_refresh":h);return n&&a&&f&&"mutation"!==e.operationKind?n.persisterFn(m,e.id,e.name,t,s,c,{query_name:e.name,preheat_source:h,[D.Zm.EXCLUDE_FROM_CACHE_KEY]:d,skip_cache:p},u,l):m()}let U={cancel:()=>!1,schedule:e=>((0,s.unstable_batchedUpdates)(e),"")};let SSRNetwork=class SSRNetwork{preloadSubscriptions(e){if(e&&"extensions"in e&&e.extensions&&e.extensions.subscriptions){let t=e.extensions.subscriptions;for(let e in t)for(let r in this.preloadedSubscriptions.has(e)||this.preloadedSubscriptions.set(e,new Map),t[e])this.preloadedSubscriptions.get(e)?.set(r,t[e][r])}}execute(e,t,r){return this.relayNetwork.execute(e,t,r)}getPreloadedSubscriptions(){return this.preloadedSubscriptions}constructor(e,t={},r,s,n,o,l,u){(0,i._)(this,"relayNetwork",void 0),(0,i._)(this,"ssrPreloadedData",void 0),(0,i._)(this,"preloadedSubscriptions",void 0),(0,i._)(this,"warningsShown",void 0),(0,i._)(this,"enabled_features",void 0),(0,i._)(this,"maxAge",void 0),(0,i._)(this,"cache",void 0),(0,i._)(this,"stalePreloadedData",void 0),(0,i._)(this,"markPreloadedDataAsStale",void 0),this.ssrPreloadedData=e,this.enabled_features=t,this.preloadedSubscriptions=r,this.warningsShown=new Set,this.maxAge=n,this.cache=o,this.stalePreloadedData=l??!1,this.markPreloadedDataAsStale=u,this.relayNetwork=a.Network.create((e,t,r)=>a.Observable.create(i=>{let a=function({params:e,variables:t,ssrPreloadedQueries:r,baseUrl:i,emitWarning:s,enabledFeatures:a,maxAge:n,observer:o,cache:l,metadata:c,stalePreloadedData:u,preloadSubscriptions:d}){if(!e.id)throw Error("params has no id property!");let h=(0,x.M3)(),f=(0,p.G7)("issues_react_hot_cache");if(e.id&&r){let i=JSON.stringify(t),s=r.get(e.id)?.get(i),a=Math.floor(Date.now()/1e3),c=s?.timestamp;if(s&&(o.next(s),!(n&&c&&a>c+n)&&!u)){if(h&&l){let r=e.metadata?.ttl,i=e.metadata?.defaultValues;void 0!==r&&r>0&&l.tryCacheFetchResult(e.id,e.name,t,s,r,{query_name:e.name,update_type:"preloaded"},i)}o.complete();return}e.metadata?.isRelayRouteRequest&&(0,N.g5)()}let _={...c??{},...e.metadata};if(N.KJ&&h&&"mutation"!==e.operationKind&&f){let{defaultValues:r,keysToExclude:i,preheatSource:s,skipCache:a,cacheEnabledForQuery:n}=$(_);if(n&&!s&&!a){let s=`${D.vp}-${(0,x.cj)()}`,a=(0,D.KE)(s,e.id,e.name,t,r,i);a&&a!==L.uY&&(d?.(a),o.next(a),(0,L.CI)())}}if(N.KJ)return M({params:e,variables:t,baseUrl:i,enabledFeatures:a,observer:o,isClientSideCachingEnabled:h,cache:l,metadata:_,preloadSubscriptions:d})}({params:e,variables:t,ssrPreloadedQueries:this.ssrPreloadedData,baseUrl:s,emitWarning:e=>{this.warningsShown.has(e)||(this.warningsShown.add(e),console.warn(e))},enabledFeatures:this.enabled_features,maxAge:n,observer:i,cache:this.cache,metadata:r.metadata,stalePreloadedData:this.stalePreloadedData,preloadSubscriptions:this.preloadSubscriptions.bind(this)});a instanceof Promise&&a.then(e=>{Array.isArray(e)||this.preloadSubscriptions(e),e&&i.next(e),i.complete()}),"mutation"===e.operationKind&&(this.stalePreloadedData=!0,this.markPreloadedDataAsStale?.(!0))}),(e,t)=>(function(e,t,r=new Map){let i=e.id,s=e.name;return a.Observable.create(a=>{let n=()=>{},o=!1;return async function(){if(!i)throw Error("unexpected operation with no id!");let l=e.metadata?.scope,u=function(e,t,r,i){let s=i.get(e);if(s)e:for(let[e,i]of s){for(let[i,s]of Object.entries(JSON.parse(e)))if("$scope"===i&&r!==s||t[i]!==s)continue e;return i}}(i,t,l,r),d=null;if(u)d=u.subscriptionId,u.response&&a.next(u.response);else try{let e=await b(i,s,t,"GET",{isSubscription:!0,scope:l});d=e.subscriptionId,e.response&&a.next(e.response)}catch(e){if(e instanceof Error&&e.message.includes("Subscription halted"))return;throw e}try{let e=await (0,T.H)();if(o)return;let r=(0,C.$)(e,d,async({scope_object:e,subscription_topic:r,dispatch_time:n})=>{try{let{response:o}=await b(i,s,{...t},"GET",{isSubscription:!0,scopeObject:e,subscriptionTopic:r,dispatchTime:n,scope:l});o&&a.next(o)}catch(e){(0,c.N7)(e,{message:`Error in fetching update for ${i} with variables ${JSON.stringify(t)}`})}});r?.unsubscribe&&(n=r.unsubscribe)}catch(e){a.error(e)}}(),{get closed(){return o},unsubscribe(){o=!0,n()}}})})(e,t,this.preloadedSubscriptions))}};let j=e=>{let t;if(N.KJ){let e=(0,p.G7)("issues_react_client_side_caching_analytics");t=(0,D.VC)({sendAnalyticsEvent:(e,t,r={})=>{let i={react:!0,version:D.L7};(0,I.BI)(e,{...i,...r,target:t})},reportableEvents:e?D.Zf.ANY:D.Zf.NONE})}let r=new SSRNetwork(new Map,{},new Map,e,void 0,t),i=new a.Environment({scheduler:U,store:new a.Store(new a.RecordSource,{gcReleaseBufferSize:50,queryCacheExpirationTime:3e5,gcScheduler:k}),getDataID:(e,t)=>{if("Viewer"===t)return null==e.id?(0,a.generateClientID)("client:root","viewer"):e.id;if("ProjectV2SingleSelectFieldOption"===t){let t=[];return e.id&&t.push(e.id),e.name&&t.push(e.name),e.color&&t.push(e.color),e.description&&t.push(function(e){let t=0;if(0===e.length)return t;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r)|0;return t}(e.description)),t.join("_")}return e.id},network:r,missingFieldHandlers:O});return i.options={baseUrl:e,getPreloadedSubscriptions:()=>r.getPreloadedSubscriptions()},i};function F({environment:e,query:t,variables:r={},metadata:i}){let s=(0,a.getRequest)(t),n=(0,a.createOperationDescriptor)(s,r);return e.retain(n),(0,a.fetchQuery)(e,t,r,{fetchPolicy:"store-or-network",networkCacheConfig:{metadata:i}})}},82606:(e,t,r)=>{let i;r.d(t,{Zm:()=>j,uY:()=>F,XA:()=>G,CI:()=>J,hz:()=>H,KE:()=>q});var s=r(69599),a=r(37285),n=r(82518),o=r(35750),l=r(18150),c=r(85242),u=r(50467);let d={status:"CLOSED",nextAttemptTime:null,failureCount:0},h="offline_cache.circuit_breaker";var p,f,_,m,E,y,w=new WeakMap,g=new WeakMap,v=new WeakMap,b=new WeakMap,S=new WeakMap,A=new WeakMap,O=new WeakMap,T=new WeakMap;let CircuitBreaker=class CircuitBreaker{constructor(e,t){(0,l._)(this,w,{writable:!0,value:void 0}),(0,l._)(this,g,{writable:!0,value:void 0}),(0,l._)(this,v,{writable:!0,value:null}),(0,u._)(this,"reportFailure",(e,t,r)=>{switch((0,o._)(this,g).lastErrorType&&(0,o._)(this,g).lastErrorType!==e&&(0,o._)(this,A).call(this,e),e){case"RateLimitError":return(0,o._)(this,b).call(this,t,r);case"ServiceUnavailableError":return(0,o._)(this,S).call(this);default:return}}),(0,u._)(this,"reportSuccess",()=>{(0,c._)(this,g,{status:"CLOSED",nextAttemptTime:null,failureCount:0}),null==(p=(0,o._)(f=this,v))||p.call(f,h,"success_reported")}),(0,u._)(this,"getStatus",()=>{if("CLOSED"===(0,o._)(this,g).status)return"CLOSED";console.log("nextAttemptTime:",(0,o._)(this,g).nextAttemptTime,"currentTime:",Date.now());let e=Date.now();return(0,o._)(this,g).nextAttemptTime&&e>=(0,o._)(this,g).nextAttemptTime?((0,c._)(this,g,{status:"CLOSED",nextAttemptTime:null,failureCount:0}),"CLOSED"):"OPEN"}),(0,l._)(this,b,{writable:!0,value:(e,t)=>{let r=null;if(void 0!==e){let t=1e3*e,i=Math.random()*t*.05;r=Date.now()+t+i}else r=void 0!==t?1e3*t+5e3*Math.random():(0,o._)(this,O).call(this,(0,o._)(this,g).failureCount+1);let i=((0,o._)(this,g).failureCount||0)+1,s=(0,o._)(this,T).call(this,(0,o._)(this,g),i),a={status:s,nextAttemptTime:r,failureCount:i,lastErrorType:"RateLimitError"};(0,c._)(this,g,a),null==(_=(0,o._)(m=this,v))||_.call(m,h,"error_reported",{error_type:"RateLimitError",new_status:s,failure_count:i,next_attempt_time:r})}}),(0,l._)(this,S,{writable:!0,value:()=>{let e=(0,o._)(this,O).call(this,(0,o._)(this,g).failureCount+1),t=((0,o._)(this,g).failureCount||0)+1,r="OPEN";(0,c._)(this,g,{status:r,nextAttemptTime:e,failureCount:t,lastErrorType:"ServiceUnavailableError"}),null==(E=(0,o._)(y=this,v))||E.call(y,h,"error_reported",{error_type:"ServiceUnavailableError",new_status:r,failure_count:t,next_attempt_time:e})}}),(0,l._)(this,A,{writable:!0,value:e=>{(0,c._)(this,g,{status:"CLOSED",nextAttemptTime:null,failureCount:0,lastErrorType:e})}}),(0,l._)(this,O,{writable:!0,value:e=>{let t=Math.min(5e3*2**(e-1),3e5),r=Math.random()*t*.25;return Date.now()+(t+r)}}),(0,l._)(this,T,{writable:!0,value:(e,t)=>"OPEN"===e.status||t>=1?"OPEN":"CLOSED"}),(0,c._)(this,w,e),(0,c._)(this,v,t),(0,c._)(this,g,d)}};var C=new WeakMap,R=new WeakMap;let k=new class LRUCache{get(e){let t=(0,o._)(this,C).get(e);return void 0!==t&&((0,o._)(this,C).delete(e),(0,o._)(this,C).set(e,t)),t}set(e,t){if((0,o._)(this,C).has(e)&&(0,o._)(this,C).delete(e),(0,o._)(this,C).set(e,t),(0,o._)(this,C).size>(0,o._)(this,R)){let e=(0,o._)(this,C).keys().next().value;void 0!==e&&(0,o._)(this,C).delete(e)}}delete(e){(0,o._)(this,C).delete(e)}clear(){(0,o._)(this,C).clear()}get size(){return(0,o._)(this,C).size}constructor(e){(0,l._)(this,C,{writable:!0,value:void 0}),(0,l._)(this,R,{writable:!0,value:void 0}),(0,c._)(this,C,new Map),(0,c._)(this,R,e)}}(250);function N(e,t,r){i&&i("hot_cache.error",t,{error_type:e,error_message:r instanceof Error?r.message:"Unknown error"})}let D={init(e){i=e},getItem(e){try{return k.get(e)}catch(t){N("get_item",e,t);return}},setItem(e,t){try{k.set(e,t)}catch(t){N("set_item",e,t)}},removeItem(e){try{k.delete(e)}catch(t){N("remove_item",e,t)}},sendAnalyticsEvent(...e){i?.(...e)},clear(){k.clear()},size:()=>k.size};var I=r(2362);let x=/^https?:\/\/[^/]+\/([^/]+)\/([^/]+)\/issues\/(\d+)$/,L={lastResult:null,pendingEvent:null,pendingEventTime:null,listenerRegistered:!1,enabled:!1},P=()=>{L.lastResult=null,L.pendingEvent=null,L.pendingEventTime=null},$=(e,t)=>{null!==t&&(0,n.au)({name:"ISSUES_SHOW_HPC",value:e.detail.hpc,tags:{cpu:e.detail.cpu||"unknown",cache_result:t,mechanism:e.detail.mechanism||"unknown"}},void 0,1)},M=e=>{if(x.test(e.detail.name))if(null!==L.lastResult){let t=L.lastResult;P(),$(e,t)}else L.pendingEvent=e,L.pendingEventTime=Date.now()},U=(e,t)=>{if(L.enabled&&"IssueViewerViewQuery"===e&&null!==t&&(L.lastResult=t,L.pendingEvent)){let e=L.lastResult,t=L.pendingEvent,r=Date.now()-(L.pendingEventTime||0);P(),r<=500&&$(t,e)}},j={EXCLUDE_FROM_CACHE_KEY:"exclude_from_cache_key"},F={};function H(e,t,r,i,s){let a={...i,...Object.fromEntries(Object.entries(r).filter(([,e])=>void 0!==e))},n=Object.keys(a).sort(),o={};for(let e of n){if(s&&s.includes(e))continue;let t=a[e];null!=t&&(o[e]=t)}return`${e}-${t}#${JSON.stringify(o)}`}function q(e,t,r,i,s,a){let n=H(e,r,i,s,a),o=D.getItem(n);if(o)return o.queryHash!==t?F:(U(r,"hit-hot"),D.sendAnalyticsEvent("hot_cache.hit",n,{}),o.state.data)}function G({storage:e,prefix:t,maxAgeMs:r,sendAnalyticsEvent:i}){let n=(0,s.G7)("issues_react_extended_preheat_analytics"),o=(0,s.G7)("issues_react_client_side_caching_cb"),l=(0,s.G7)("issues_react_custom_hpc_metric"),c=`${t}-circuit-breaker`,u=o?new CircuitBreaker(c,i):void 0;async function d(r,s,a,n,o){if(!e)return;let l=H(t,s,a,o,n?.[j.EXCLUDE_FROM_CACHE_KEY]);try{let t=await e.getItem(l,V(n));if(t&&t.queryHash!==r)return F;return t?.state.data}catch(e){i(I.Zf.CACHE_READ_ERROR,l,{error:String(e)});return}}async function h(t){if(e)try{D.removeItem(t),await e.removeItem(t)}catch(e){i(I.Zf.CACHE_EVICT_ERROR,t,{error:String(e)})}}async function p(r,s,a,n,o,l,c,u){if(!e)return;let d=H(t,s,a,c,l?.[j.EXCLUDE_FROM_CACHE_KEY]),h={queryHash:r,queryKey:Object.entries(a).flat(),state:{data:n,dataUpdatedAt:Date.now(),ttl:o,preheatSource:u}};try{u&&D.setItem(d,h),await e.setItem(d,h,void 0,void 0,V(l))}catch(e){i(I.Zf.CACHE_WRITE_ERROR,d,{error:String(e)})}}return l&&(L.listenerRegistered||(document.addEventListener("web-vitals:hpc",M),L.listenerRegistered=!0),L.enabled=!0),D.init(i),{persisterFn:async function(s,o,l,c,f,_,m,E,y){var w,g,v,b,S,A,O;let T,C=await d(o,l,c,m,E),R=H(t,l,c,E,m?.[j.EXCLUDE_FROM_CACHE_KEY]),k=void 0!==C&&C!==F,N=m?.preheat_source,I=!!N,x=!!m?.skip_cache,L=null,P=null;if(k?("object"==typeof C&&null!==C&&"data"in C&&(L=JSON.stringify(C.data)),(0,a.Av)({__trace:{query_name:m?.query_name,query_id:o,query_variables:c,duration_ms:1,cache_result:"hit"}}),I||x||(U(l,"hit"),y?.(C),f.next(C),J())):U(l,"miss"),I&&k){let e={queryHash:o,queryKey:Object.entries(c).flat(),state:{data:C,dataUpdatedAt:Date.now(),ttl:_,preheatSource:N}};D.setItem(R,e),n&&N&&i("offline_cache.preheat_noop",R,{preheatSource:N});return}let $=u?.getStatus()??"CLOSED";try{if(I&&"OPEN"===$)return;T=await s(k)}catch(e){if(k)return X([{message:e instanceof Error?e.message:"Unknown error"}]),C;throw e}let M=K(T);if(k&&M&&X(T.errors),I)if(M){let e=function(e){if(!e)return{shouldBackoff:!1};if("object"==typeof e&&"extensions"in e&&"object"==typeof e.extensions&&null!==e.extensions&&"backoff"in e.extensions){let t=e.extensions,r="string"==typeof t.errorType?t.errorType:void 0,i="number"==typeof t.retryAfter?t.retryAfter:void 0,s="number"==typeof t.resetTime?t.resetTime:void 0;return{shouldBackoff:!!t.backoff,errorType:r,retryAfter:i,resetTime:s}}return{shouldBackoff:!1}}(T);e.shouldBackoff&&u?.reportFailure(e.errorType??"Unknown",e.retryAfter,e.resetTime)}else"OPEN"===$&&u?.reportSuccess();let q=(w=T,!!(g=C)&&(g===F||!!w&&K(w))),G=!(!(v=T)||"object"==typeof v&&"errors"in v&&Array.isArray(v.errors)&&v.errors.length>0);if(e&&q)h(R);else if(G&&e){"object"==typeof T&&null!==T&&"data"in T&&(P=JSON.stringify(T.data));let e=(b=!!C,S=L,A=P,O=I,x?"force_refresh":b?S!==A?"changed":"unchanged":O?"pre_heated":"new");p(o,l,c,T,_??r,{...m,update_type:e},E,N)}if(!I)return T},retrieveQuery:d,tryCacheFetchResult:p}}function V(e){if(!e)return;let t={};for(let[r,i]of Object.entries(e))Object.values(j).includes(r)||(t[r]=i);return t}function K(e){return"object"==typeof e&&null!==e&&"errors"in e&&Array.isArray(e.errors)&&e.errors.length>0}function X(e){"undefined"!=typeof window&&window.dispatchEvent(new CustomEvent("stale-cache-warning",{detail:{errors:e}}))}function J(){"undefined"==typeof window||(0,n.Xl)()&&window.dispatchEvent(new CustomEvent("relay-cache-hit"))}},86185:(e,t,r)=>{r.d(t,{z:()=>p});var i=r(35750),s=r(18150),a=r(87057),n=r(69599),o=r(82075);let l="VERSION_MISMATCH_LAST_TRIGGERED",c=(0,o.A)("localStorage",{ttl:9e7,throwQuotaErrorsOnSet:!1}),u=null;let VersionMismatchRateLimiter=class VersionMismatchRateLimiter{canTrigger(){let e=this.getLastTriggerTime();return null===e||Date.now()-e>=864e5}recordTrigger(){let e=Date.now();c.setItem(l,e.toString()),u=e}getLastTriggerTime(){let e=c.getItem(l);if(e){let t=parseInt(e,10);return isNaN(t)?null:t}return u}clearTriggerRecord(){c.removeItem(l),u=null}};let d=new VersionMismatchRateLimiter;var h=new WeakMap;let p=new class VersionMismatchDetector{registerApp(e,t){(0,i._)(this,h).set(e,t)}unregisterApp(e){(0,i._)(this,h).delete(e)}checkResponse(e,t){if("true"!==e.headers.get("X-GitHub-Version-Mismatch")||!(0,n.G7)("react_version_mismatch_detection")||!d.canTrigger())return!1;let r={clientVersion:(0,a.O)(),serverVersion:e.headers.get("X-GitHub-Server-Version")||void 0,requestUrl:e.url,responseHeaders:e.headers,appName:t};if(d.recordTrigger(),t){let e=(0,i._)(this,h).get(t);if(e)return e.onMismatchDetected(r),!0}else{let e=!1;for(let[t,s]of(0,i._)(this,h).entries()){let i={...r,appName:t};s.onMismatchDetected(i),e=!0}return e}return!1}constructor(){(0,s._)(this,h,{writable:!0,value:new Map})}}},87683:(e,t,r)=>{r.d(t,{KE:()=>a.KE,L7:()=>c,VC:()=>u,Zf:()=>i.Zf,Zm:()=>a.Zm,vp:()=>o});var i=r(2362),s=r(21067),a=r(82606);let n={Check:e=>"object"==typeof e&&null!==e&&(void 0===e.data||"object"==typeof e.data)&&(void 0===e.errors||!!Array.isArray(e.errors)),Code:()=>"manual-validator",Errors:()=>[]},o="relay-query",l=6048e5,c="1.0.8",u=({sendAnalyticsEvent:e,reportableEvents:t=i.Zf.ANY,maxAgeMs:r=l})=>{let c=(0,i.i5)({validator:n,sendAnalyticsEvent:(r,...s)=>{t!==i.Zf.NONE&&(t===i.Zf.ANY||Array.isArray(t)&&t.includes(r))&&e(r,...s)}});return(0,a.XA)({storage:c,prefix:`${o}-${(0,s.cj)()}`,maxAgeMs:r,sendAnalyticsEvent:e})}}}]);
//# sourceMappingURL=30721-92b68e51766b.js.map